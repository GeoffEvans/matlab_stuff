function psfaod()

lambda = 800e-9;
V = 613;
[t,x1,y1] = GetSamplingRanges();
xVel = 00;
yVel = 00;
focusDeviation = -0.000;

[aodAcDirectionVectors, aodL, chirpFactor] = Aod6cyclic2();

tic
[xy,~] = CalculateRayEnds();
toc

figure();
hist3(xy);
xlabel('x')
ylabel('y') 
        
    function [xy,aberrationVar] = CalculateRayEnds()
        numberOfAods = length(aodL);
        linearChirps = arrayfun(@NthAodChirp, 1:length(aodL));
                                                                                   
        x = cell(1,numberOfAods+1); 
        y = cell(1,numberOfAods+1); 
        z = cell(1,numberOfAods+1); 
        x{1} = x1;
        y{1} = y1;
        z{1} = 0;
        
        figure();
        hold on
        for n = 1:numberOfAods
            [x{n+1},y{n+1}] = GetNextXyPositions(n);  % Stores the (n+1)th [x,y]
            z{n+1} = z{n} + aodL(n);
            line([x{n};x{n+1}],[y{n};y{n+1}],[z{n};z{n+1}]);
            fill3([max(x{n}) max(x{n}) min(x{n}) min(x{n})],[max(y{n}) min(y{n}) min(y{n}) max(y{n})],repmat([z{n}],1,4),repmat([z{n}],1,4))
        end
        hold off
        alpha(0.1)
        
        xEnd = x{end} - xVel * t;
        yEnd = y{end} - yVel * t;
        xy = [xEnd(:) yEnd(:)];
        aberrationVar = var(xEnd) + var(yEnd); % sum x and y vars
             
        function [xNplus1,yNplus1] = GetNextXyPositions(n)
            angle = NthDeflectionAngle(1);
            for m = 2:n
                angle = angle + NthDeflectionAngle(m);
            end
            distance = aodL(n);
            if n == length(aodL)
                distance = distance + focusDeviation;
            end
            xNplus1 = x{n} + angle(1,:) * distance;
            yNplus1 = y{n} + angle(2,:) * distance;
        end   
        
        function fnangle = NthDeflectionAngle(n) 
            kn = aodAcDirectionVectors{n};
            kx = kn(1);
            ky = kn(2);
            phase = t - ( x{n}*kx + y{n}*ky ) / V;
            fnangle = aodAcDirectionVectors{n} * linearChirps(n) * phase * lambda/V;
        end
        
        function chirp = NthAodChirp(n)
            chirp = V*V/lambda * chirpFactor(n);
        end
    end

    function [aodDirectionVectors, aodL, chirpFactor] = Aod4()
        aodDirectionVectors = {[1;0], [0;1]};
        aodDirectionVectors = [aodDirectionVectors, cellfun(@(x) x*(-1), aodDirectionVectors,'UniformOutput', false)];
        aodL = [5, 5, 5, 5e1];
        l1 = aodL(1);
        l2 = aodL(2);
        l3 = aodL(3);
        l4 = aodL(4);
        chirpFactor = [ 1/(l1 + l2 + 2*l3 + 2*l4)...
                        1/(l2 + l3 + 2*l4)...
                           1/(2*(l3 + l4))...
                                  1/(2*l4)];
    end

    function [aodDirectionVectors, aodL, chirpFactor] = Aod6cyclic1()
            aodDirectionVectors = {[1;0], [1;sqrt(3)]/2, [-1;sqrt(3)]/2, [-1;0], -[1;sqrt(3)]/2, -[-1;sqrt(3)]/2};
            aodL = [5, 5, 5 ,5 ,5 , 5e0];
            L = aodL(1);
            f = aodL(6);
            chirpFactor =  [((2396*L^4*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) - 952*L^2*f - 616*L^3 - 336*L*f^2 + (288*f^4*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (6236*L^2*f^2*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (2352*L*f^3*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (6568*L^3*f*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4))/(5616*L^4 + 12008*L^3*f + 8816*L^2*f^2 + 2712*L*f^3 + 288*f^4)...
     ((2396*L^4*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) - 2024*L^2*f - 1096*L^3 - 192*f^3 - 1120*L*f^2 + (288*f^4*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (6236*L^2*f^2*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (2352*L*f^3*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (6568*L^3*f*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4))/(4080*L^4 + 9204*L^3*f + 7236*L^2*f^2 + 2400*L*f^3 + 288*f^4)...
      -((2396*L^4*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) - 3000*L^2*f - 1696*L^3 - 240*f^3 - 1544*L*f^2 + (288*f^4*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (6236*L^2*f^2*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (2352*L*f^3*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (6568*L^3*f*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4))/(1020*L^4 + 2196*L^3*f + 1668*L^2*f^2 + 564*L*f^3 + 72*f^4)...
     ((2396*L^4*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) - 2600*L^2*f - 1480*L^3 - 192*f^3 - 1312*L*f^2 + (288*f^4*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (6236*L^2*f^2*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (2352*L*f^3*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4) + (6568*L^3*f*(1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2)))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4))/(2592*L^4 + 6240*L^3*f + 5400*L^2*f^2 + 2040*L*f^3 + 288*f^4)...
    (1416*L*f^3 + 7120*L^3*f + 3436*L^4 + 144*f^4 + 4956*L^2*f^2 + (3908880*L^8 + 17964864*L^7*f + 35058208*L^6*f^2 + 37968128*L^5*f^3 + 24981520*L^4*f^4 + 10231488*L^3*f^5 + 2547648*L^2*f^6 + 352512*L*f^7 + 20736*f^8)^(1/2))/(2396*L^5 + 6568*L^4*f + 6236*L^3*f^2 + 2352*L^2*f^3 + 288*L*f^4)...
    0];
    end
    function [aodDirectionVectors, aodL, chirpFactor] = Aod6cyclic2()
            aodDirectionVectors = {[-1;sqrt(3)]/2, [-1;0], -[1;sqrt(3)]/2, -[-1;sqrt(3)]/2, [1;0], [1;sqrt(3)]/2};
            aodL = [5e-2, 5e-2, 5e-2 ,5e-2 ,5e-2 , 5e0];
            L = aodL(1);
            f = aodL(6);
            v = 1;
            chirpFactor =  [  (5*(260000*f + (1700*v)/3 + 17920*f*v - (8493465600000000*f^8 - 849346560000000*f^7*v + 5803868160000000*f^7 + 21233664000000*f^6*v^2 - 484835328000000*f^6*v + 1698103296000000*f^6 + 9533030400000*f^5*v^2 - 115472793600000*f^5*v + 277659648000000*f^5 + 15482880000*f^4*v^3 + 1701089280000*f^4*v^2 - 14854103040000*f^4*v + 27730411520000*f^4 + 4640256000*f^3*v^3 + 153363456000*f^3*v^2 - 1112004608000*f^3*v + (5190545408000*f^3)/3 + 1742400*f^2*v^4 + 506860800*f^2*v^3 + 7281056000*f^2*v^2 - (144894361600*f^2*v)/3 + (591786188800*f^2)/9 + 287760*f*v^4 + 23604000*f*v^3 + 169535040*f*v^2 - (10109079680*f*v)/9 + (12501767680*f)/9 + 11881*v^4 + (1157944*v^3)/3 + 1481720*v^2 - (290810528*v)/27 + 1010151184/81)^(1/2) + 840*f*v^2 + 134400*f^2*v + 4665600*f^2 + 34560000*f^3 + 92160000*f^4 + 71*v^2 + 14692/3))/((4800*f^2 + 880*f + 3*v + 86/3)*(1860*f - 49*v - 600*f*v + 9600*f^2 + 254/3)) - (10*(2304000*f^3*v + 652800*f^2*v + 67200*f^2 + 2160*f*v^2 + 52760*f*v + 6800*f + 177*v^2 + 1204*v + 380/3))/((4800*f^2 + 880*f + 3*v + 86/3)*(1860*f - 49*v - 600*f*v + 9600*f^2 + 254/3));...
                                                                                                     -(126060*v - 10879200*f + 6055200*f*v + 45*(8493465600000000*f^8 - 849346560000000*f^7*v + 5803868160000000*f^7 + 21233664000000*f^6*v^2 - 484835328000000*f^6*v + 1698103296000000*f^6 + 9533030400000*f^5*v^2 - 115472793600000*f^5*v + 277659648000000*f^5 + 15482880000*f^4*v^3 + 1701089280000*f^4*v^2 - 14854103040000*f^4*v + 27730411520000*f^4 + 4640256000*f^3*v^3 + 153363456000*f^3*v^2 - 1112004608000*f^3*v + (5190545408000*f^3)/3 + 1742400*f^2*v^4 + 506860800*f^2*v^3 + 7281056000*f^2*v^2 - (144894361600*f^2*v)/3 + (591786188800*f^2)/9 + 287760*f*v^4 + 23604000*f*v^3 + 169535040*f*v^2 - (10109079680*f*v)/9 + (12501767680*f)/9 + 11881*v^4 + (1157944*v^3)/3 + 1481720*v^2 - (290810528*v)/27 + 1010151184/81)^(1/2) + 70200*f*v^2 + 88992000*f^2*v + 414720000*f^3*v - 201888000*f^2 - 1555200000*f^3 - 4147200000*f^4 + 5895*v^2 - 204020)/(945540*f - v*(31104000*f^3 + 6566400*f^2 + 452250*f + 9972) - v^2*(3240*f + 270) + 17964000*f^2 + 145152000*f^3 + 414720000*f^4 + 17856);...
                                                                                                                                 (52500*v - 8020800*f + 2876400*f*v + 45*(8493465600000000*f^8 - 849346560000000*f^7*v + 5803868160000000*f^7 + 21233664000000*f^6*v^2 - 484835328000000*f^6*v + 1698103296000000*f^6 + 9533030400000*f^5*v^2 - 115472793600000*f^5*v + 277659648000000*f^5 + 15482880000*f^4*v^3 + 1701089280000*f^4*v^2 - 14854103040000*f^4*v + 27730411520000*f^4 + 4640256000*f^3*v^3 + 153363456000*f^3*v^2 - 1112004608000*f^3*v + (5190545408000*f^3)/3 + 1742400*f^2*v^4 + 506860800*f^2*v^3 + 7281056000*f^2*v^2 - (144894361600*f^2*v)/3 + (591786188800*f^2)/9 + 287760*f*v^4 + 23604000*f*v^3 + 169535040*f*v^2 - (10109079680*f*v)/9 + (12501767680*f)/9 + 11881*v^4 + (1157944*v^3)/3 + 1481720*v^2 - (290810528*v)/27 + 1010151184/81)^(1/2) + 59400*f*v^2 + 44064000*f^2*v + 207360000*f^3*v - 163008000*f^2 - 1382400000*f^3 - 4147200000*f^4 + 4905*v^2 - 134860)/(241920*f - v*(7776000*f^3 + 1749600*f^2 + 131760*f + 3366) + 4334400*f^2 + 34560000*f^3 + 103680000*f^4 + 5100);...
                                                                                                                           (10641600*f - 101580*v - 4467600*f*v - 45*(8493465600000000*f^8 - 849346560000000*f^7*v + 5803868160000000*f^7 + 21233664000000*f^6*v^2 - 484835328000000*f^6*v + 1698103296000000*f^6 + 9533030400000*f^5*v^2 - 115472793600000*f^5*v + 277659648000000*f^5 + 15482880000*f^4*v^3 + 1701089280000*f^4*v^2 - 14854103040000*f^4*v + 27730411520000*f^4 + 4640256000*f^3*v^3 + 153363456000*f^3*v^2 - 1112004608000*f^3*v + (5190545408000*f^3)/3 + 1742400*f^2*v^4 + 506860800*f^2*v^3 + 7281056000*f^2*v^2 - (144894361600*f^2*v)/3 + (591786188800*f^2)/9 + 287760*f*v^4 + 23604000*f*v^3 + 169535040*f*v^2 - (10109079680*f*v)/9 + (12501767680*f)/9 + 11881*v^4 + (1157944*v^3)/3 + 1481720*v^2 - (290810528*v)/27 + 1010151184/81)^(1/2) + 59400*f*v^2 - 56160000*f^2*v - 207360000*f^3*v + 201600000*f^2 + 1555200000*f^3 + 4147200000*f^4 + 4905*v^2 + 188660)/(725040*f - v*(25920000*f^3 + 5356800*f^2 + 351000*f + 7056) + 15084000*f^2 + 132192000*f^3 + 414720000*f^4 + 12192);...
                                                                                                                                                       (20*(260000*f + (1700*v)/3 + 17920*f*v - (8493465600000000*f^8 - 849346560000000*f^7*v + 5803868160000000*f^7 + 21233664000000*f^6*v^2 - 484835328000000*f^6*v + 1698103296000000*f^6 + 9533030400000*f^5*v^2 - 115472793600000*f^5*v + 277659648000000*f^5 + 15482880000*f^4*v^3 + 1701089280000*f^4*v^2 - 14854103040000*f^4*v + 27730411520000*f^4 + 4640256000*f^3*v^3 + 153363456000*f^3*v^2 - 1112004608000*f^3*v + (5190545408000*f^3)/3 + 1742400*f^2*v^4 + 506860800*f^2*v^3 + 7281056000*f^2*v^2 - (144894361600*f^2*v)/3 + (591786188800*f^2)/9 + 287760*f*v^4 + 23604000*f*v^3 + 169535040*f*v^2 - (10109079680*f*v)/9 + (12501767680*f)/9 + 11881*v^4 + (1157944*v^3)/3 + 1481720*v^2 - (290810528*v)/27 + 1010151184/81)^(1/2) + 840*f*v^2 + 134400*f^2*v + 4665600*f^2 + 34560000*f^3 + 92160000*f^4 + 71*v^2 + 14692/3))/(184320000*f^4 + 56832000*f^3 + 134400*f^2*v + 5782400*f^2 + 16840*f*v + (705040*f)/3 + 9*v^2 + (1364*v)/3 + 29828/9);...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1/(3*f)];
    end
end

function [t,x1,y1] = GetSamplingRanges()
    xRange = normrnd(0,10,1,10);
    yRange = xRange;
    tRange = 0:0.020:0.100;
    [x1temp,y1temp] = meshgrid(xRange,yRange);
    [x1temp,ttemp] = meshgrid(x1temp(:),tRange);
    [y1temp,~] = meshgrid(y1temp(:),tRange);
    x1 = x1temp(:)';
    y1 = y1temp(:)';
    t = ttemp(:)';
end

